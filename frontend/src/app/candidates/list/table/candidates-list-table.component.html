<div class="table-responsive">
  <table
    style="width: 100%;"
    mat-table
    [dataSource]="service.rows"
    matSort
    (matSortChange)="service.doChangeSort($event)"
    [matSortActive]="service.sorter.columnKey"
    [matSortDirection]="service.sorter.order"
  >
    <ng-container matColumnDef="_select">
      <th mat-header-cell *matHeaderCellDef>
        <app-table-th-checkbox
          [rows]="service.rows"
          [selectedKeys]="service.selectedKeys"
        ></app-table-th-checkbox>
      </th>
      <td mat-cell *matCellDef="let row">
        <app-table-td-checkbox
          [row]="row"
          [selectedKeys]="service.selectedKeys"
        ></app-table-td-checkbox>
      </td>
    </ng-container>

    <ng-container
      [matColumnDef]="fields.candidateName.name"
    >
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        {{ fields.candidateName.label }}
      </th>
      <td mat-cell *matCellDef="let row">
        {{ presenter(row, 'candidateName') }}
      </td>
    </ng-container>
    <ng-container [matColumnDef]="fields.currentPosition.name">
      <th mat-header-cell *matHeaderCellDef>
        {{ fields.currentPosition.label }}
      </th>
      <td mat-cell *matCellDef="let row">
        <app-table-item-relation-to-one
          [url]="fields.currentPosition.viewUrl"
          [permission]="fields.currentPosition.readPermission"
          [value]="presenter(row, 'currentPosition')"
        ></app-table-item-relation-to-one>
      </td>
    </ng-container>
    <ng-container
      [matColumnDef]="fields.candidateReference.name"
    >
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        {{ fields.candidateReference.label }}
      </th>
      <td mat-cell *matCellDef="let row">
        {{ presenter(row, 'candidateReference') }}
      </td>
    </ng-container>
    <ng-container
      [matColumnDef]="fields.gender.name"
    >
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        {{ fields.gender.label }}
      </th>
      <td mat-cell *matCellDef="let row">
        {{ presenter(row, 'gender') }}
      </td>
    </ng-container>
    <ng-container [matColumnDef]="fields.academicCertificateSpecialization.name">
      <th mat-header-cell *matHeaderCellDef>
        {{ fields.academicCertificateSpecialization.label }}
      </th>
      <td mat-cell *matCellDef="let row">
        <app-table-item-relation-to-one
          [url]="fields.academicCertificateSpecialization.viewUrl"
          [permission]="fields.academicCertificateSpecialization.readPermission"
          [value]="presenter(row, 'academicCertificateSpecialization')"
        ></app-table-item-relation-to-one>
      </td>
    </ng-container>
    <ng-container [matColumnDef]="fields.trainingCertificates.name">
      <th mat-header-cell *matHeaderCellDef>
        {{ fields.trainingCertificates.label }}
      </th>
      <td mat-cell *matCellDef="let row">
        <app-table-item-relation-to-one
          [url]="fields.trainingCertificates.viewUrl"
          [permission]="fields.trainingCertificates.readPermission"
          [value]="presenter(row, 'trainingCertificates')"
        ></app-table-item-relation-to-one>
      </td>
    </ng-container>
    <ng-container
      [matColumnDef]="fields.currentCompany.name"
    >
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        {{ fields.currentCompany.label }}
      </th>
      <td mat-cell *matCellDef="let row">
        {{ presenter(row, 'currentCompany') }}
      </td>
    </ng-container>
    <ng-container
      [matColumnDef]="fields.noticePeriod.name"
    >
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        {{ fields.noticePeriod.label }}
      </th>
      <td mat-cell *matCellDef="let row">
        {{ presenter(row, 'noticePeriod') }}
      </td>
    </ng-container>
    <ng-container
      [matColumnDef]="fields.currentSalary.name"
    >
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        {{ fields.currentSalary.label }}
      </th>
      <td mat-cell *matCellDef="let row">
        {{ presenter(row, 'currentSalary') }}
      </td>
    </ng-container>
    <ng-container
      [matColumnDef]="fields.expectedSalary.name"
    >
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        {{ fields.expectedSalary.label }}
      </th>
      <td mat-cell *matCellDef="let row">
        {{ presenter(row, 'expectedSalary') }}
      </td>
    </ng-container>
    <ng-container [matColumnDef]="fields.softSkills.name">
      <th mat-header-cell *matHeaderCellDef>
        {{ fields.softSkills.label }}
      </th>
      <td mat-cell *matCellDef="let row">
        <app-table-item-relation-to-one
          [url]="fields.softSkills.viewUrl"
          [permission]="fields.softSkills.readPermission"
          [value]="presenter(row, 'softSkills')"
        ></app-table-item-relation-to-one>
      </td>
    </ng-container>
    <ng-container [matColumnDef]="fields.managementSkills.name">
      <th mat-header-cell *matHeaderCellDef>
        {{ fields.managementSkills.label }}
      </th>
      <td mat-cell *matCellDef="let row">
        <app-table-item-relation-to-one
          [url]="fields.managementSkills.viewUrl"
          [permission]="fields.managementSkills.readPermission"
          [value]="presenter(row, 'managementSkills')"
        ></app-table-item-relation-to-one>
      </td>
    </ng-container>
    <ng-container [matColumnDef]="fields.artisticSkills.name">
      <th mat-header-cell *matHeaderCellDef>
        {{ fields.artisticSkills.label }}
      </th>
      <td mat-cell *matCellDef="let row">
        <app-table-item-relation-to-one
          [url]="fields.artisticSkills.viewUrl"
          [permission]="fields.artisticSkills.readPermission"
          [value]="presenter(row, 'artisticSkills')"
        ></app-table-item-relation-to-one>
      </td>
    </ng-container>
    <ng-container
      [matColumnDef]="fields.candidateCreatedDate.name"
    >
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        {{ fields.candidateCreatedDate.label }}
      </th>
      <td mat-cell *matCellDef="let row">
        {{ presenter(row, 'candidateCreatedDate') }}
      </td>
    </ng-container>
    <ng-container [matColumnDef]="fields.jobs.name">
      <th mat-header-cell *matHeaderCellDef>
        {{ fields.jobs.label }}
      </th>
      <td mat-cell *matCellDef="let row">
        <app-table-item-relation-to-one
          [url]="fields.jobs.viewUrl"
          [permission]="fields.jobs.readPermission"
          [value]="presenter(row, 'jobs')"
        ></app-table-item-relation-to-one>
      </td>
    </ng-container>
    <ng-container [matColumnDef]="fields.resume.name">
      <th mat-header-cell *matHeaderCellDef>
        {{ fields.resume.label }}
      </th>
      <td mat-cell *matCellDef="let row">
        <app-table-item-files
          [value]="presenter(row, 'resume')"
        ></app-table-item-files>
      </td>
    </ng-container>
    <ng-container [matColumnDef]="fields.photo.name">
      <th mat-header-cell *matHeaderCellDef>
        {{ fields.photo.label }}
      </th>
      <td mat-cell *matCellDef="let row">
        <app-table-item-images
          [value]="presenter(row, 'photo')"
        ></app-table-item-images>
      </td>
    </ng-container>

    <ng-container matColumnDef="_actions">
      <th mat-header-cell *matHeaderCellDef></th>
      <td
        style="width: 180px; text-align: right;"
        mat-cell
        *matCellDef="let row"
      >
        <button
          mat-icon-button
          type="button"
          color="primary"
          [routerLink]="['/candidates', row.id]"
          [matTooltip]="i18n('common.view')"
        >
          <mat-icon>search</mat-icon>
        </button>

        <button
          mat-icon-button
          type="button"
          color="primary"
          *ngIf="hasPermissionToEdit"
          [routerLink]="['/candidates', row.id, 'edit']"
          [matTooltip]="i18n('common.edit')"
        >
          <mat-icon>edit</mat-icon>
        </button>

        <button
          mat-icon-button
          type="button"
          color="primary"
          *ngIf="hasPermissionToDestroy"
          (click)="doDestroy(row.id)"
          [matTooltip]="i18n('common.destroy')"
        >
          <mat-icon>delete</mat-icon>
        </button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="columns"></tr>
    <tr
      mat-row
      *matRowDef="let row; columns: this.columns"
    ></tr>
  </table>

  <div
    *ngIf="!service.loading && !service.count"
    class="mat-table-message"
  >
    <app-i18n key="table.noData"></app-i18n>
  </div>

  <div *ngIf="service.loading" class="mat-table-message">
    <app-i18n key="table.loading"></app-i18n>
  </div>
</div>

<mat-paginator
  [disabled]="service.loading"
  [pageIndex]="service.paginationPageIndex"
  [pageSize]="service.paginationPageSize"
  [pageSizeOptions]="[10, 20, 30, 40]"
  [length]="service.count"
  (page)="service.doChangePagination($event)"
  showFirstLastButtons
></mat-paginator>
